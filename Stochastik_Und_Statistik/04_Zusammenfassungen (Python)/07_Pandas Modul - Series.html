<!doctype html>
<html>
<head>
    <title>07_Pandas Modul - Series</title>
    <meta charset="utf-8">
    
</head>
<body>
<p></p><h4><span style="font-size: 0.9375rem;">Das Modul wird meist wie folgt importiert:</span><br></h4><p><span><span><i><span class="" style="color: rgb(1, 100, 167);">import pandas as pd</span></i></span></span><br></p><p>Wir beginnen mit beiden wichtigsten Daten-Strukturen von Pandas:</p><p></p><ul><li><span>Series und</span></li><li>DataFrame</li></ul><p></p><h4>Series</h4><p>Eine Series ist ein eindimensionales Array-ähnliches Objekt. Es kann verschiedene Daten-Typen aufnehmen, z.B. Integers, Floats, Strings, Python-Objekte, usw.</p><p>Eine Series kann als eine Datenstruktur mit zwei Arrays angesehen werden: Ein Array fungiert als Index, d.h. als Bezeichner (Label), und ein Array beinhaltet die aktuellen Daten (Werte).<br></p><p><i><span><span><span class="" style="color: rgb(1, 100, 167);">i</span><span class="" style="color: rgb(1, 100, 167);"><span class="" style="color: rgb(1, 100, 167);">mp</span>ort pandas as pd</span></span><br></span><span><span class="" style="color: rgb(1, 100, 167);">S = pd.Series([11, 28, 72, 3, 5, 8])</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">print(S)</span><br><span class="" style="color: rgb(1, 100, 167);">OUT:&nbsp;&nbsp;</span></span><span><span class="" style="color: rgb(1, 100, 167);">0&nbsp; &nbsp; 11</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1&nbsp; &nbsp; 28</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2&nbsp; &nbsp; 72</span><br></span><span><span><i><span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></span></i><span class="" style="color: rgb(1, 100, 167);">3&nbsp; &nbsp; &nbsp;3</span></span><br></span><span><span><i><span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></span></i><span class="" style="color: rgb(1, 100, 167);">4&nbsp; &nbsp; &nbsp;5</span></span><br></span><span><span><i><span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></span></i><span class="" style="color: rgb(1, 100, 167);">5&nbsp; &nbsp; &nbsp;8</span></span><br></span><span><i><span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></span></i><span class="" style="color: rgb(1, 100, 167);">dtype: int64</span></span></i></p><p><span>In diesem Beispiel wurde kein Index definiert. Trotzdem sieht man zwei Spalten in der Ausgabe: Die rechte Spalte zeigt unsere Daten, die linke Spalte stellt den Index dar. Pandas erstellt einen Default-Index, der bei 0 beginnt und hier bis 5 läuft.</span></p><p>Wir können direkt auf die Indizes und die Werte der Series S zugreifen:</p><p><i><span><span class="" style="color: rgb(1, 100, 167);">print(S.index)</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">print(S.values)</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">OUT:&nbsp;RangeIndex(start=0, stop=6, step=1)</span><br></span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[11 28 72&nbsp; 3&nbsp; 5&nbsp; 8]</span></i></p><p><span><span>Wenn wir dies mit der Erstellung eines Arrays in NumPy vergleichen, stellen wir viele Gemeinsamkeiten fest:</span></span></p><p><i><span class="" style="color: rgb(1, 100, 167);">import numpy as np</span><br><span><span class="" style="color: rgb(1, 100, 167);">X = np.array([11, 28, 72, 3, 5, 8])</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">print(X)</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">print(S.values)</span><br></span><span><span class="" style="color: rgb(1, 100, 167);"># both are the same type:</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">print(type(S.values), type(X))</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">OUT: [11 28 72&nbsp; 3&nbsp; 5&nbsp; 8]</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[11 28 72&nbsp; 3&nbsp; 5&nbsp; 8]</span><br></span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;class 'numpy.ndarray'&gt; &lt;class 'numpy.ndarray'&gt;</span></i></p><p>Bis hierhin unterscheiden sich die Series noch nicht wirklich von den Arrays aus NumPy. Das ändert sich aber, sobald wir Series-Objekte mit individuellen Indizes definieren:</p><p><i><span><span class="" style="color: rgb(1, 100, 167);">fruits = ['apples', 'oranges', 'cherries', 'pears']</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">quantities = [20, 33, 52, 10]</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">S = pd.Series(quantities, index=fruits)</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">print(S)</span><br><span class="" style="color: rgb(1, 100, 167);">OUT:&nbsp;</span></span><span><span class="" style="color: rgb(1, 100, 167);">apples&nbsp; &nbsp; &nbsp; 20</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;oranges&nbsp; &nbsp; &nbsp;33</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cherries&nbsp; &nbsp; 52</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pears&nbsp; &nbsp; &nbsp; &nbsp;10</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dtype: int64</span></span></i></p><p>Einen grosser Vorteil gegenüber NumPy-Arrays erkennt man hierbei: Wir können beliebige Indizes verwenden.</p><p><span>Wenn wir zwei Series-Objekte mit denselben Indizes addieren, so erhalten wir ein neues Series-Objekt mit diesem Index, und die Werte entsprechen den Summen der entsprechenden Werte aus den beiden Series-Objekten.</span><br></p><p><i><span><span class="" style="color: rgb(1, 100, 167);">fruits = ['apples', 'oranges', 'cherries', 'pears']</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">S = pd.Series([20, 33, 52, 10], index=fruits)</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">S2 = pd.Series([17, 13, 31, 32], index=fruits)</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">print(S + S2)</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">print("Summe aus S: ", sum(S))</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">OUT: apples&nbsp; &nbsp; &nbsp; 37</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;oranges&nbsp; &nbsp; &nbsp;46</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cherries&nbsp; &nbsp; 83</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pears&nbsp; &nbsp; &nbsp; &nbsp;42</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dtype: int64</span><br></span><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Summe aus S:&nbsp; 115</span></i></p><p>Die Indizes müssen nicht identisch sein für die Addition von Series-Typen. Der resultierende Index ist eine "Vereinigung" beider Indizes. Wenn ein Index nicht in beiden Series-Objekten vorkommt, so wird der entsprechende Wert auf NaN gesetzt:</p><p><i><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">fruits = ['peaches', 'oranges', 'cherries', 'pears']</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">fruits2 = ['raspberries', 'oranges', 'cherries', 'pears']</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">S1 = pd.Series([20, 33, 52, 10], index=fruits)</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">S2 = pd.Series([17, 13, 31, 32], index=fruits2)</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">print(S1 + S2)</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">OUT: cherries&nbsp; &nbsp; &nbsp; &nbsp;83.0</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;oranges&nbsp; &nbsp; &nbsp; &nbsp; 46.0</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;peaches&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;NaN</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pears&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 42.0</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;raspberries&nbsp; &nbsp; &nbsp;NaN</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dtype: float64</span></span></i></p><h4><span class="">Indizierung</span></h4><p><span style="font-size: 0.9375rem;">Es ist möglich, auf einzelne Werte eines Series-Objektes zuzugreifen:</span><br></p><p><i><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">print(S['apples'])</span><br></span><span style="font-size: 0.9375rem; color: rgb(1, 100, 167);" class="">OUT: 20</span></i></p><p>Man kann auch auf mehrere Indizes gleichzeitig zugreifen, wenn man die Indices als Liste übergibt:</p><p><span style="font-size: 0.9375rem;"><i><span class="" style="color: rgb(1, 100, 167);">print(S[['apples', 'oranges', 'cherries']])</span><br></i></span><span style="font-size: 0.9375rem;"><i><span class="" style="color: rgb(1, 100, 167);">OUT: apples&nbsp; &nbsp; &nbsp; 20</span><br></i><span style="font-size: 0.9375rem;"><i><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;oranges&nbsp; &nbsp; 33</span><br></i><span style="font-size: 0.9375rem;"><i><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cherries&nbsp; &nbsp; 52</span></i><br></span></span></span></p><p>Filterung mit einem Booleschen Array:</p><p><i>S[S&gt;30]<br><span style="font-size: 0.9375rem;">OUT:&nbsp;</span><span style="font-size: 0.9375rem;">oranges&nbsp; &nbsp; 33<br></span><span style="font-size: 0.9375rem;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cherries&nbsp; &nbsp; 52</span></i></p><h4><span style="font-size: 0.9375rem;"><span style="font-size: 0.9375rem;"><span style="font-size: 0.9375rem;"><h4>Mathematische Funktionen</h4></span></span></span></h4><p><span style="font-size: 0.9375rem;"><span style="font-size: 0.9375rem;"><span style="font-size: 0.9375rem;">Wie bei NumPy sind auch Operationen mit Skalaren oder die Anwendung von mathematischen Funktionen auf ein Series-Objekt möglich:</span><br></span></span></p><p><span style="font-size: 0.9375rem;">import numpy as np<br></span><span style="font-size: 0.9375rem;">print((S + 3) * 4)<br></span><span style="font-size: 0.9375rem;">print("======================")<br></span><span style="font-size: 0.9375rem;">print(np.sin(S))<br></span><span style="font-size: 0.9375rem;">OUT: apples&nbsp; &nbsp; &nbsp; 92<br></span><span style="font-size: 0.9375rem;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;oranges&nbsp; &nbsp; 144<br></span><span style="font-size: 0.9375rem;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cherries&nbsp; &nbsp; 220<br></span><span style="font-size: 0.9375rem;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pears&nbsp; &nbsp; &nbsp; &nbsp; 52<br></span><span style="font-size: 0.9375rem;">======================<br></span><span style="font-size: 0.9375rem;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;apples&nbsp; &nbsp; &nbsp;0.912945<br></span><span style="font-size: 0.9375rem;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;oranges&nbsp; &nbsp;0.999912<br></span><span style="font-size: 0.9375rem;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cherries&nbsp; &nbsp;0.986628<br></span><span style="font-size: 0.9375rem;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pears&nbsp; &nbsp; &nbsp; -0.544021</span></p><p>Diese Funktionen können auch anderweitig auf das Series-Element angewendet werden:</p><p><span style="font-size: 0.9375rem;">pandas.Series.apply<br></span><span style="font-size: 0.9375rem;">Series.apply(func, convert_dtype=True, args=(), **kwds)</span></p><p><span style="font-size: 0.9375rem;">Die Funktion "func" wird auf das Series-Objekt angwendet und liefert, in Abhängigkeit von "func", entweder ein Series-Objekt oder ein DataFrame-Objekt zurück.</span><br></p><p><i><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">S.apply(np.log)</span><br><span class="" style="color: rgb(1, 100, 167);">OUT:&nbsp;</span></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">apples&nbsp; &nbsp; &nbsp;2.995732</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;oranges&nbsp; &nbsp;3.496508</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cherries&nbsp; &nbsp;3.951244</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pears&nbsp; &nbsp; &nbsp; &nbsp;2.302585</span></span></i></p><p>Wir können auch Python-Lambda-Funktionen benutzen. Wir werden nun die Anzahl der Früchte prüfen: Wenn weniger als 50 von einer Sorte vorhanden sind, so soll der Bestand um 10 erhöht werden. Ansonsten lassen wir den Betrag unverändert:</p><p><i><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">S.apply(lambda x: x if x &gt; 50 else x+10 )</span><br><span class="" style="color: rgb(1, 100, 167);">OUT:&nbsp;</span></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">apples&nbsp; &nbsp; &nbsp;30</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;oranges&nbsp; &nbsp;43</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cherries&nbsp; &nbsp;52</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pears&nbsp; &nbsp; &nbsp; &nbsp;20</span></span></i></p><p></p>
</body>
</html>