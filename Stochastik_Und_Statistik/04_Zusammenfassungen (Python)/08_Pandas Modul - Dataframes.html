<!doctype html>
<html>
<head>
    <title>08_Pandas Modul - Dataframes</title>
    <meta charset="utf-8">
    
</head>
<body>
<p></p><h4><span style="font-size: 0.9375rem;">Das Modul wird meist wie folgt importiert:</span><br></h4><p><span><span><i><span class="" style="color: rgb(1, 100, 167);">import pandas as pd</span></i></span></span><br></p><p>Wir beginnen mit beiden wichtigsten Daten-Strukturen von Pandas:</p><p></p><ul><li><span>Series und</span></li><li>DataFrame</li></ul><p></p><h4><span style="font-size: 1.40625rem; color: rgb(51, 51, 51);">Dataframes</span><br></h4><p><span><span style=""><span class="" style=""><span class="" style="color: rgb(51, 51, 51);">Bislang haben wir gesehen, dass der Datentyp Series logisch gesehen einer Spalte mit Index einer Excel-Tabelle entspricht. Nun geht es um den Datentyp DataFrame, den man sich nun wie eine komplette Excel-Tabelle vorstellen kann. Man kann also sagen, dass dieser Datentyp auf Tabellen basiert. Ein DataFrame besteht aus einer geordneten Sequenz von Spalten. Jede Spalte besteht aus einem eindeutigen Daten-Typ -- wie eine Series, -- aber verschiedene Spalten können verschiedene Typen haben. So könnte beispielsweise eine Spalte Verkaufszahlen als Float-Zahlen enthalten, während eine andere die zugehörigen Jahreszahlen als Integer-Zahlen enthalten könnte.</span><br></span></span></span></p><p><i><span class="" style="color: rgb(1, 100, 167);">import pandas as pd</span><br><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">years = range(2014, 2018)</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">shop1 = pd.Series([2409.14, 2941.01, 3496.83, 3119.55], index=years)</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">shop2 = pd.Series([1203.45, 3441.62, 3007.83, 3619.53], index=years)</span><br></span><span style="color: rgb(1, 100, 167); font-size: 0.9375rem;" class="">shop3 = pd.Series([3412.12, 3491.16, 3457.19, 1963.10], index=years)</span></i></p><p>Was passiert, wenn diese "shop"-Series-Objekte konkateniert werden? Pandas stellt eine concat()-Funktion für diesen Zweck zur Verfügung:</p><p><i><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">pd.concat([shop1, shop2, shop3])</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">OUT:</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2014&nbsp; &nbsp; 2409.14</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2015&nbsp; &nbsp; 2941.01</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2016&nbsp; &nbsp; 3496.83</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2017&nbsp; &nbsp; 3119.55</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2014&nbsp; &nbsp; 1203.45</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2015&nbsp; &nbsp; 3441.62</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2016&nbsp; &nbsp; 3007.83</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2017&nbsp; &nbsp; 3619.53</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2014&nbsp; &nbsp; 3412.12</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2015&nbsp; &nbsp; 3491.16</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2016&nbsp; &nbsp; 3457.19</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2017&nbsp; &nbsp; 1963.10</span><br></span><span style="color: rgb(1, 100, 167); font-size: 0.9375rem;" class="">dtype: float64</span></i></p><p>Das Ergebnis ist wohl nicht das, was wir erwartet haben. Der Grund dafür ist, dass concat() für den axis-Parameter 0 verwendet. Probieren wir es mit "axis=1":</p><p><i><span class="" style="color: rgb(1, 100, 167);">shops_df = pd.concat([shop1, shop2, shop3], axis=1)</span><br><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">print(shops_df)</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">OUT:</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2014&nbsp; 2409.14&nbsp; 1203.45&nbsp; 3412.12</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2015&nbsp; 2941.01&nbsp; 3441.62&nbsp; 3491.16</span><br></span><span style="color: rgb(51, 51, 51); font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2016&nbsp; 3496.83&nbsp; 3007.83&nbsp; 3457.19</span><br></span><span style="color: rgb(1, 100, 167); font-size: 0.9375rem;" class="">2017&nbsp; 3119.55&nbsp; 3619.53&nbsp; 1963.10</span></i></p><p>Die Frage ist, von welchem Datentyp das Ergebnis ist:</p><p><i><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">print(type(shops_df))</span><br></span><span style="font-size: 0.9375rem; color: rgb(1, 100, 167);" class="">OUT: &lt;class 'pandas.core.frame.DataFrame'&gt;</span></i></p><p>Das bedeutet, dass wir Series-Objekte durch Konkatenierung in DataFrame-Objekte wandeln können.</p><p>Die Spaltennamen lauten:</p><p><i><span class="" style="color: rgb(1, 100, 167);">print(shops_df.columns)<br>OUT:&nbsp;RangeIndex(start=0, stop=3, step=1)</span></i></p><p>Die Spaltenwerte lauten:</p><p><i><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">print(shops_df.columns.values)</span><br></span><span style="font-size: 0.9375rem; color: rgb(1, 100, 167);" class="">OUT: array([0, 1, 2])</span></i></p><p>Wir geben den Spalten noch Namen, um das DataFrame etwas leichter lesbar zu machen:</p><p><i><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">cities = ["Zürich", "Winterthur", "Freiburg"]</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">shops_df.columns = cities&nbsp;</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">print(shops_df)</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">OUT:&nbsp; &nbsp; &nbsp; &nbsp;</span><br><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Zürich&nbsp; Winterthur&nbsp; Freiburg</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2014&nbsp; 2409.14&nbsp; &nbsp; &nbsp;1203.45&nbsp; &nbsp;3412.12</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2015&nbsp; 2941.01&nbsp; &nbsp; &nbsp;3441.62&nbsp; &nbsp;3491.16</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2016&nbsp; 3496.83&nbsp; &nbsp; &nbsp;3007.83&nbsp; &nbsp;3457.19</span><br></span><span style="font-size: 0.9375rem; color: rgb(1, 100, 167);" class="">2017&nbsp; 3119.55&nbsp; &nbsp; &nbsp;3619.53&nbsp; &nbsp;1963.10</span></i></p><p>Andererseits wäre eine Umbenennung in unserem Fall überhaupt nicht notwendig gewesen, wenn die Series bereits entsprechend benamt gewesen wären:</p><p><i><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">shop1.name = "Zürich"</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">shop2.name = "Winterthur"</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">shop3.name = "Freiburg"</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">shops_df2 = pd.concat([shop1, shop2, shop3], axis=1)</span><br></span></i><span style="font-size: 0.9375rem;"><i><span class="" style="color: rgb(1, 100, 167);">print(shops_df2)</span><br><span><span><span class="" style="color: rgb(1, 100, 167);">OUT:&nbsp; &nbsp; &nbsp; &nbsp;</span><br><span class="" style="color: rgb(1, 100, 167);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Zürich&nbsp; Winterthur&nbsp; Freiburg</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">2014&nbsp; 2409.14&nbsp; &nbsp; &nbsp;1203.45&nbsp; &nbsp;3412.12</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">2015&nbsp; 2941.01&nbsp; &nbsp; &nbsp;3441.62&nbsp; &nbsp;3491.16</span><br></span><span><span class="" style="color: rgb(1, 100, 167);">2016&nbsp; 3496.83&nbsp; &nbsp; &nbsp;3007.83&nbsp; &nbsp;3457.19</span><br></span><span class="" style="color: rgb(1, 100, 167);">2017&nbsp; 3119.55&nbsp; &nbsp; &nbsp;3619.53&nbsp; &nbsp;1963.10</span></span></i><br></span></p><p>Auf die Spalten eines Dataframes können wir einfach durch Indizierung zugreifen:</p><p><i><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">print(shops_df["Zürich"])</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">OUT: </span><br><span class="" style="color: rgb(1, 100, 167);">2014&nbsp; &nbsp; 2409.14</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2015&nbsp; &nbsp; 2941.01</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2016&nbsp; &nbsp; 3496.83</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2017&nbsp; &nbsp; 3119.55</span><br></span><span style="font-size: 0.9375rem; color: rgb(1, 100, 167);" class="">Name: Zürich, dtype: float64</span></i></p><p>Jede einzelne der Spalten entsprach ursprünglich einer Series und entspricht auch immer noch einer Series. Dies können wir sehen, wenn wir uns den Typ anschauen:</p><p><i><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">print(type(shops_df["Zürich"]))</span><br></span><span style="font-size: 0.9375rem; color: rgb(1, 100, 167);" class="">OUT: &lt;class 'pandas.core.series.Series'&gt;</span></i></p><p>Pandas bietet noch eine syntaktisch deutlich einfachere Methode, auf die Spalten zuzugreifen. Die Spaltennamen wurden dazu als Properties implementiert, und dies bedeutet, dass man einfach den Spaltennamen mittels Punkt an das Dataframe anhängen kann, um die entsprechende Spalte anzusprechen.</p><p><i><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">print(shops_df.Zürich)</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">OUT:</span><br><span class="" style="color: rgb(1, 100, 167);">2014&nbsp; &nbsp; 2409.14</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2015&nbsp; &nbsp; 2941.01</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2016&nbsp; &nbsp; 3496.83</span><br></span><span style="font-size: 0.9375rem;"><span class="" style="color: rgb(1, 100, 167);">2017&nbsp; &nbsp; 3119.55</span><br></span><span style="font-size: 0.9375rem; color: rgb(1, 100, 167);" class="">Name: Zürich, dtype: float64</span></i></p><p><br></p><p><br></p><p></p>
</body>
</html>